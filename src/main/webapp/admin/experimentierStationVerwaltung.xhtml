<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:shiro="http://shiro.apache.org/tags">
<h:head>
    <title>Experimentier Station Verwaltung - SFB Farbige Zustaende</title>
    <link rel="icon" href="../background.png"/>
</h:head>
<body background="../background.png">
<shiro:authenticated>
    <shiro:hasRole name="admin">
        <ui:composition template="/template/common/layout.xhtml">
            <ui:define name="content">
                <div class="ui-g-8">
                    <p:growl>
                        <p:autoUpdate/>
                    </p:growl>
                    <p:panelGrid columns="1">
                        <p:row>
                            <h2 style="color: cornflowerblue">#{msg['esV.jsf']}</h2>
                        </p:row>
                        <p:row>
                            <p>#{msg['esVerwaltungText.jsf']}<br/>
                                #{msg['esVerwaltungText2.jsf']}</p>
                        </p:row>
                        <p:row>
                            <p:panelGrid>
                                <h:form id="form">
                                    <p:row>
                                        <h3 style="color: cornflowerblue">#{msg['esEinf√ºgen.jsf']}</h3>
                                    </p:row>
                                    <p:row>
                                        <p:column colspan="1">
                                            <h:outputText value="Name:"/>
                                        </p:column>
                                        <p:column colspan="1">
                                            <p:inputText placeholder="Name" required="true"
                                                         value="#{adminBean.experimentierStationName}"
                                                         requiredMessage="#{msg['esVerwaltungMeldung2.jsf']}"/>
                                        </p:column>
                                        <p:column colspan="1">
                                            <h:outputText value="#{msg['standort.jsf']}:"/>
                                        </p:column>
                                        <p:column colspan="1">
                                            <p:selectOneMenu id="standort"
                                                             value="#{adminBean.experimentierStationStandort}"
                                                             converter="omnifaces.SelectItemsConverter" effect="fade"
                                                             var="standort" style="width: 172px" filter="true"
                                                             filterMatchMode="contains" required="true"
                                                             requiredMessage="#{msg['esVerwaltungMeldung.jsf']}">
                                                <f:selectItems value="#{adminBean.allLocations}"
                                                               var="standort" itemLabel="#{standort.ort}"
                                                               itemValue="#{standort}" required="true"/>
                                                <p:column>
                                                    <h:outputText value="#{standort.ort}"/>
                                                </p:column>
                                            </p:selectOneMenu>
                                        </p:column>
                                    </p:row>
                                    <p:row>
                                        <p:column colspan="1">
                                            <h:outputText value="#{msg['zugewUser.jsf']}"/>
                                        </p:column>
                                        <p:column colspan="1">
                                            <p:selectCheckboxMenu id="userTable"
                                                                  value="#{adminBean.experimentierStationBenutzer}"
                                                                  converter="omnifaces.SelectItemsConverter"
                                                                  effect="fade"
                                                                  var="user" style="width: 172px" filter="true"
                                                                  filterMatchMode="contains" showCheckbox="true"
                                                                  label="#{msg['user.jsf']}"
                                                                  requiredMessage="Bitte Benutzer Zuweisen!"
                                                                  required="true">
                                                <f:selectItems value="#{adminBean.allUsers}"
                                                               var="user" itemLabel="#{user.username}"
                                                               itemValue="#{user}" required="true"/>
                                            </p:selectCheckboxMenu>
                                        </p:column>
                                        <p:column colspan="1">
                                            <p:commandButton value="#{msg['reset.jsf']}" type="reset"/>
                                        </p:column>
                                        <p:column colspan="1">
                                            <p:commandButton value="#{msg['erstellen.jsf']}"
                                                             action="#{adminBean.addStation}" icon="pi pi-check"
                                                             update="form2" ajax="true"/>
                                        </p:column>
                                    </p:row>
                                </h:form>
                            </p:panelGrid>
                        </p:row>
                        <br/>
                        <p:row>
                            <h:form id="form2">
                                <p:growl>
                                    <p:autoUpdate/>
                                </p:growl>
                                <p:dataTable id="table" var="station" value="#{adminBean.experimentierStations}"
                                             editable="true"
                                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
                                             paginator="true" rows="6" style="margin-bottom:20px">
                                    <p:ajax event="rowEdit" listener="#{adminBean.onRowEditES(station.esID)}"
                                            update="form2:table"/>
                                    <p:ajax event="rowEditCancel" listener="#{adminBean.onRowEditCancelES}"
                                            update="form2:table"/>
                                    <p:column headerText="Name">
                                        <p:cellEditor>
                                            <f:facet name="output">
                                                <h:outputText value="#{station.name}"/>
                                            </f:facet>
                                            <f:facet name="input">
                                                <p:inputText value="#{adminBean.experimentierStationName}" label="Name"
                                                             required="true"
                                                             requiredMessage="#{msg['esVerwaltungMeldung2.jsf']}"
                                                             placeholder="Name"/>
                                            </f:facet>
                                        </p:cellEditor>
                                    </p:column>
                                    <p:column headerText="#{msg['standort.jsf']}">
                                        <p:cellEditor>
                                            <f:facet name="output">
                                                <h:outputText value="#{station.standort.ort}"/>
                                            </f:facet>
                                            <f:facet name="input">
                                                <p:selectOneMenu id="standortTable"
                                                                 value="#{adminBean.experimentierStationStandort}"
                                                                 converter="omnifaces.SelectItemsConverter"
                                                                 effect="fade"
                                                                 var="standort" style="width: 172px" filter="true"
                                                                 filterMatchMode="contains" required="true"
                                                                 requiredMessage="#{msg['esVerwaltungMeldung.jsf']}">
                                                    <f:selectItems value="#{adminBean.allLocations}"
                                                                   var="standort" itemLabel="#{standort.ort}"
                                                                   itemValue="#{standort}" required="true"/>
                                                    <p:column>
                                                        <h:outputText value="#{standort.ort}"/>
                                                    </p:column>
                                                </p:selectOneMenu>
                                            </f:facet>
                                        </p:cellEditor>
                                    </p:column>
                                    <p:column headerText="#{msg['zugewUser.jsf']}">
                                        <p:cellEditor>
                                            <f:facet name="output">
                                                <h:outputText value="#{station.benutzer}"/>
                                            </f:facet>
                                            <f:facet name="input">
                                                <p:selectCheckboxMenu id="user"
                                                                      value="#{adminBean.experimentierStationBenutzer}"
                                                                      converter="omnifaces.SelectItemsConverter"
                                                                      effect="fade"
                                                                      var="user" style="width: 172px" filter="true"
                                                                      filterMatchMode="contains" showCheckbox="true"
                                                                      label="Benutzer"
                                                                      requiredMessage="#{msg['esVerwaltungMeldung3.jsf']}"
                                                                      required="true">
                                                    <f:selectItems value="#{adminBean.allUsers}"
                                                                   var="user" itemLabel="#{user.username}"
                                                                   itemValue="#{user}" required="true"/>
                                                </p:selectCheckboxMenu>
                                            </f:facet>
                                        </p:cellEditor>
                                    </p:column>
                                    <p:column headerText="#{msg['zustand.jsf']}">
                                        <h:outputText value="#{station.status}"/>
                                    </p:column>
                                    <p:column>
                                        <p:commandButton ajax="true" action="#{adminBean.deleteStation(station.esID)}"
                                                         value="#{msg['delete.jsf']}" icon="pi pi-trash" update="form2:table"/>
                                    </p:column>
                                    <p:column style="width: 35px">
                                        <p:rowEditor/>
                                    </p:column>
                                </p:dataTable>
                            </h:form>
                        </p:row>
                    </p:panelGrid>
                </div>
            </ui:define>
        </ui:composition>
    </shiro:hasRole>
</shiro:authenticated>
</body>
</html>
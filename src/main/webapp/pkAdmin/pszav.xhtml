<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">
<ui:define name="metadata">
    <f:metadata>
        <f:viewAction action="#{languageBean.setLanguage}"/>
    </f:metadata>
</ui:define>

<h:head>
</h:head>
<h:body>

    <ui:composition template="/template/common/layout.xhtml">
        <ui:define name="content">
            <p:panelGrid columns="1">
                <p:row>
                    <h2 style="color: cornflowerblue">Prozessschrittzustandsautomatvorlagen Verwaltung</h2>
                </p:row>
                <p:row>
                    <p>Hier koennen Sie neue Prozesschrittzustandsautomatvorlagen erstellen, welche spaeter von den
                        Prozessschritten verwendet werden koennen. Sie koennen beliebig viele zustaende hinzufuegen, allerdings
                        muessen die Zustaende "Erstellt" und "Freigegeben" immeran erster Stelle kommen.
                        Weitere zustaende existieren, werden hier allerdings nicht angezeigt, da Sie nur fuer den Transport bzw.
                        den Technologen relevant sind.</p>
                </p:row>
                <p:row>
                    <p:panel header="Zustaende einfuegen">
                        <h:form>
                            <p:panelGrid>
                                <p:row>
                                    <p:column colspan="1">
                                        <h:outputText value="Zustandsname"/>
                                    </p:column>
                                    <p:column colspan="1">
                                        <p:inputText placeholder="Zistandsname" required="true"
                                                     requiredMessage="Bitte Zustaendsname eingeben!"
                                                     value="#{pszavView.zustandsname}"/>
                                    </p:column>
                                    <p:column colspan="1">
                                        <p:commandButton value="Reset" type="reset" icon="pi pi-trash"/>
                                    </p:column>
                                    <p:column colspan="1">
                                        <p:commandButton value="Einfuegen" icon="pi pi-check"
                                                         action="#{pszavView.addToAutomaton}" ajax="false"/>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                        </h:form>
                    </p:panel>
                </p:row>
                <p:row>
                    <p:panel id="pszav" header="Zustandsautomat Erstellen"
                             style="margin-bottom: 20px">
                        <h:form>
                            <p:panelGrid cellpadding="10">
                                <p:row>
                                    <p:column colspan="1">
                                        <p:outputLabel for="zustandV" value="Zustandsreihenfolge: "/>
                                    </p:column>
                                    <p:column colspan="3">
                                        <p:pickList id="zustandV" value="#{pszavView.dualZ}" var="zustand"
                                                    itemLabel="#{zustand}"
                                                    itemValue="#{zustand}"/>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column colspan="1">
                                        <p:outputLabel value="Zustandsautomatvorlage Name:" for="name"/>
                                    </p:column>
                                    <p:column colspan="1">
                                        <p:inputText value="#{pszavView.name}" id="name"/>
                                    </p:column>
                                    <p:column colspan="1">
                                        <p:commandButton value="Reset" type="reset" icon="pi pi-trash"/>
                                    </p:column>
                                    <p:column colspan="1">
                                        <p:commandButton value="Erstellen"
                                                         action="#{pszavView.erstellePSZAV}" icon="pi pi-check"
                                                         update="form:pszavList" ajax="false"/>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                        </h:form>
                    </p:panel>
                </p:row>
            </p:panelGrid>


            <h:form id="form">
                <p:growl id="msgs" showDetail="true" sticky="true"/>

                <p:dataTable widgetVar="table"
                             id="pszavList"
                             var="pszav"
                             value="#{pszavView.verpszav}"
                             editable="true"
                             selection="#{pszavView.selpszav}"
                             filteredValue="#{pszavView.filteredpszav}"
                             emptyMessage="No pszav found with given criteria"
                             rowKey="#{pszav.id}"
                             paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
                             paginator="true" rows="50" style="margin-bottom:20px">

                    <f:facet name="header">
                        <p:outputPanel>
                            <h:outputText value="Search all fields:"/>
                            <p:inputText id="globalFilter" onkeyup="PF('table').filter()" style="width:150px"
                                         placeholder="Enter keyword"/>
                        </p:outputPanel>
                    </f:facet>

                    <p:ajax event="rowEdit" listener="#{pszavView.onRowEdit}" update=":form:msgs"/>
                    <p:ajax event="rowEditCancel" listener="#{pszavView.onRowCancel}" update=":form:msgs"/>
                    <p:column selectionMode="multiple"
                              style="width:16px;text-align:center"/>


                    <p:column headerText="Id" filterBy="#{pszav.id}" footerText="in" filterMatchMode="contains">
                        <p:cellEditor>
                            <f:facet name="output"><h:outputText value="#{pszav.id}"/></f:facet>
                            <f:facet name="input"><p:inputText id="ID" value="#{pszav.id}"
                                                               style="width:100%"/></f:facet>
                        </p:cellEditor>
                    </p:column>

                    <p:column headerText="Name Bearbeiten" filterBy="#{pszav.name}" footerText="in"
                              filterMatchMode="contains">
                        <p:cellEditor>
                            <f:facet name="output"><h:outputText value="#{pszav.name}"/> </f:facet>
                            <f:facet name="input"><p:inputText value="#{pszav.name}"/> </f:facet>
                        </p:cellEditor>
                    </p:column>

                    <p:column headerText="Schritt Vorlagen" filterBy="#{pszav.zustaende}" footerText="in"
                              filterMatchMode="contains">
                        <p:cellEditor>
                            <f:facet name="output"><h:outputText value="#{pszav.zustaende}"/></f:facet>
                            <f:facet name="input">
                                <p:orderList value="#{pszav.zustaende}" var="zustand" controlsLocation="none"
                                             itemLabel="#{zustand}"
                                             itemValue="#{zustand}"/>
                            </f:facet>
                        </p:cellEditor>
                    </p:column>
                    <p:column headerText="Hinzufungen">

                        <p:commandButton value="ADD"
                                         action="#{pszavView.toAdd(pszav.id)}" icon="pi pi-plus"
                                         update="@form"/>
                    </p:column>
                    <p:column style="width:35px">
                        <p:rowEditor/>
                    </p:column>
                </p:dataTable>

                <p:contextMenu for="pszavList">
                    <p:menuitem value="Delete selected" update="pszavList"
                                icon="pi pi-times" action="#{pszavView.deletePSZAV}"/>
                </p:contextMenu>

            </h:form>

        </ui:define>
    </ui:composition>
</h:body>
</html>
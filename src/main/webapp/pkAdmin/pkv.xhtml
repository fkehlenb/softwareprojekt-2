<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui" xmlns:o="http://omnifaces.org/ui">
<ui:define name="metadata">
    <f:metadata>
        <f:viewAction action="#{languageBean.setLanguage}"/>
    </f:metadata>
</ui:define>

<h:head>
</h:head>
<h:body>
    <ui:composition template="/template/common/layout.xhtml">
        <ui:define name="content">
            <p:panelGrid columns="1">
                <p:growl>
                    <p:autoUpdate/>
                </p:growl>
                <p:row>
                    <h2 style="color: cornflowerblue">Prozesskettenvorlagen Verwaltung</h2>
                </p:row>
                <p:row>
                    <p>In der unteren Tabelle sehen Sie alle Prozesskettenvorlagen die sich im System befinden.
                        Mit dem unteren Formular koennen Sie neue Prozesskettenvorlagen erstellen. Diese Prozesskettenvorlagen
                        koennen Sie dann verwenden um neue Prozessketten automatisiert zu erstellen, in dem Sie auf
                        die Auftragsverwaltungswebsite gehen. Um neue Prozessketten aus bestehenden Prozessschritten zu machen,
                        gehen Sie bitte auf die Auftragsverwaltungswebsite.</p>
                </p:row>
                <p:row>
                    <p:panel id="pkv" header="Prozessketten Vorlage Erstellen"
                             style="margin-bottom: 20px">
                        <h:form>
                            <p:panelGrid cellpadding="10">
                                <p:row>
                                    <p:column colspan="1">
                                        <p:outputLabel for="psvV" value="Prozessschritt Reihenfolge"/>
                                    </p:column>
                                    <p:column colspan="3">
                                        <p:pickList id="psvV" value="#{pkvView.psvs}" var="psvs" itemLabel="#{psvs}"
                                                    itemValue="#{psvs}">
                                            <o:converter converterId="omnifaces.ListConverter"
                                                         list="#{pkvView.psvs.source}"/>
                                        </p:pickList>
                                    </p:column>
                                </p:row>
                                <p:row>
                                    <p:column colspan="1">
                                        <h:outputText value="Prozesskettenvorlage Name"/>
                                    </p:column>
                                    <p:column colspan="1">
                                        <p:inputText placeholder="Name" required="true"
                                                     requiredMessage="Bitte Prozesskettenvorlage Name eingeben!"
                                                     value="#{pkvView.selectedName}"/>
                                    </p:column>
                                    <p:column colspan="1">
                                        <p:commandButton value="Reset" type="reset" icon="pi pi-trash"/>
                                    </p:column>
                                    <p:column colspan="1">
                                        <p:commandButton value="Erstellen"
                                                         action="#{pkvView.erstellePSK}" icon="pi pi-check" ajax="false"/>
                                    </p:column>
                                </p:row>
                            </p:panelGrid>
                        </h:form>
                    </p:panel>
                </p:row>

                <h:form id="form">
                    <p:dataTable id="PSKList" var="pkv" value="#{pkvView.verPKV}"
                                 editable="true"
                                 paginatorTemplate="{CurrentPageReport}  {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {Exporters}"
                                 paginator="true" rows="15" style="margin-bottom:20px">
                        <p:ajax event="rowEdit" listener="#{pkvView.onRowEdit(pkv.pkvID)}" update="form:PSKList"/>
                        <p:ajax event="rowEditCancel" listener="#{pkvView.onRowCancel}" update="form:PSKList"/>
                        <p:column headerText="Prozessschrittvorlage Name">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <h:outputText value="#{pkv.name}"/>
                                </f:facet>
                                <f:facet name="input">
                                    <p:inputText placeholder="Name" required="true"
                                                 requiredMessage="Bitte Prozesskettenvorlage Name eingeben!"
                                                 value="#{pkvView.selectedName}"/>
                                </f:facet>
                            </p:cellEditor>
                        </p:column>
                        <p:column headerText="Schritt Vorlagen">
                            <p:cellEditor>
                                <f:facet name="output">
                                    <p:commandButton value="Anzeigen" icon="pi pi-external-link" update="dialog1" oncomplete="PF('dlg1').show();"/>
                                    <p:sidebar header="ProzessSchritt Uebersicht" widgetVar="dlg1" modal="true" id="dialog1"
                                              height="100" style="width: 50%">
                                        <p:panelGrid columns="1">
                                            <p:row>
                                                <p:dataTable id="tableqle" var="ps" value="#{pkv.prozessSchrittVorlagen}"
                                                             editable="true" style="margin-bottom:20px" scrollable="true" scrollHeight="400">
                                                    <p:column headerText="Name">
                                                        <h:outputText value="#{ps.name}"/>
                                                    </p:column>
                                                    <p:column headerText="Experimentierstation">
                                                        <h:outputText value="#{ps.experimentierStation}"/>
                                                    </p:column>
                                                    <p:column headerText="Dauer">
                                                        <h:outputText value="#{ps.dauer}"/>
                                                    </p:column>
                                                </p:dataTable>
                                            </p:row>
                                        </p:panelGrid>
                                    </p:sidebar>
                                </f:facet>
                                <f:facet name="input">
                                    <p:pickList id="psvV2" value="#{pkvView.psvs}" var="psvs" itemLabel="#{psvs}"
                                                itemValue="#{psvs}">
                                        <o:converter converterId="omnifaces.ListConverter"
                                                     list="#{pkvView.psvs.source}"/>
                                    </p:pickList>
                                </f:facet>
                            </p:cellEditor>
                        </p:column>
                        <p:column>
                            <p:commandButton value="Delete" icon="pi pi-trash" action="#{pkvView.deletePKV(pkv.pkvID)}"
                                             ajax="true" update="form:PSKList"/>
                        </p:column>
                        <p:column style="width:35px">
                            <p:rowEditor/>
                        </p:column>
                    </p:dataTable>
                </h:form>
            </p:panelGrid>
        </ui:define>
    </ui:composition>
</h:body>
</html>